---
layout: "post"
title: "Vim 自动补全Golang遇到的问题"
categories: "blog"
tags: ['vim']
published: true
comments: true
script: [post.js]
excerpted: |
    升级到go1.12后引发的小意外...
---

* TOC
{:toc}

最近滚了以下系统（arch），可能是go升级了，导致原本的go开发环境没有补全了（也可能是因为我把YCM重新编译了一次，把`--go-completer`也加上了）。我本地维护了两个`GOPATH`，一个自己平时用，一个给公司的项目用，两个环境都没有补全了。

google了一下发现负责golang补全的服务`nsf/gocode`似乎自1.10以后不维护了，转到了一个叫做`mdempsky/gocode`的项目。

YCM本身支持go的补全，但是用的`gocode`是那个不维护的版本，网上有个方法是手动修改，使用`mdempsky/gocode`，见[这里](https://github.com/Valloric/YouCompleteMe/issues/3074). 可是，一旦将`GOPATH`改掉之后，就又没有补全了。这个具体原因没有找到。

后面发现其实`vim-go`本身就会使用`$GOPATH/bin/gocode`来起一个服务，因此直接用`vim-go`的就可以了，而且`vim-go`里面用的`gocode`是最新的版本（维护版）。

总结，解决方法是：

1. 重新编译YCM，不要加入`--go-completer`
2. 使用`vim-go`做补全
